<VirtualHost *:80>
    ServerName YOUR_DOMAIN

    # Port must match KUMA_PORT in .env
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:3001/
    ProxyPassReverse / http://127.0.0.1:3001/

    # Keep WebSocket connections alive (Kuma uses long-lived connections)
    ProxyTimeout 86400

    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteRule /(.*) ws://127.0.0.1:3001/$1 [P,L]
</VirtualHost>
